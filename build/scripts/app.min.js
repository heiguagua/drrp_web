"use strict";var app=angular.module("app",["Config","ui.router","ui.bootstrap","treeControl","isteven-multi-select","Login","Main","Dashboard","Admin","Admin.User","Admin.Department","Department","DataQuota","DataQuotaList","DataQuotaDetail","Department.Inventory","Department.Audit","Department.Requirement","DepartmentShare"]);app.config(["$stateProvider","$urlRouterProvider","$httpProvider","$provide",function(e,t,a,n){a.interceptors.push(["$q",function(e){return{request:function(e){return e.withCredentials=!0,e},requestError:function(e){return e},response:function(t){return e.when(t,function(e){t.data&&"object"==typeof t.data&&300===e.data.head.status&&(sessionStorage.message="登陆超时，请重新登陆！",window.location.href="/")}),t},responseError:function(e){return e}}}]),t.otherwise("/login"),e.state("login",{url:"/login",templateUrl:"views/common/login.html",controller:"Login.Controller.Main"}).state("main",{url:"/main",templateUrl:"views/common/main.html",controller:"Main.Controller.Main"}).state("main.dashboard",{url:"/dashboard",templateUrl:"views/common/dashboard.html",controller:"Dashboard.Controller.Main"}).state("main.admin",{url:"/admin",templateUrl:"views/admin/main.html",controller:"Admin.Controller.Main"}).state("main.admin.department",{url:"/dashboard",templateUrl:"views/admin/department.html",controller:"Admin.Department.Controller.Main"}).state("main.admin.user",{url:"/user",templateUrl:"views/admin/user.html",controller:"Admin.User.Controller.Main"}).state("main.data-quota",{url:"/data-quota",templateUrl:"views/data-quota/main.html",controller:"DataQuota.Controller.Main"}).state("main.data-quota.list",{url:"/list/:resource_dep_id/:dep_name",templateUrl:"views/data-quota/list.html",controller:"DataQuotaList.Controller.Main"}).state("main.data-quota.detail",{url:"/detail/:resource_id",templateUrl:"views/data-quota/detail.html",controller:"DataQuotaDetail.Controller.Main"}).state("main.department",{url:"/department",templateUrl:"views/department/main.html"}).state("main.department.summary",{url:"/summary",cache:"false",reload:!0,templateUrl:"views/department/summary.html",controller:"Department.Controller.Main"}).state("main.department.inventory",{url:"/inventory",cache:"false",templateUrl:"views/department/inventory.html",controller:"Department.Inventory.Controller.Main"}).state("main.department.inventory.publish",{url:"/publish",templateUrl:"views/department/inventory-publish.html",controller:"Department.Inventory.Controller.publish"}).state("main.department.inventory.update",{url:"/update/{item:json}",params:{item:null},templateUrl:"views/department/inventory-update.html",controller:"Department.Inventory.Controller.publish"}).state("main.department.detail",{url:"/detail/{item:json}",params:{item:null},cache:"false",templateUrl:"views/department/inventory-detail.html",controller:"Department.Inventory.Controller.detail"}).state("main.department.share",{url:"/share",templateUrl:"views/department/share.html",controller:"DepartmentShare.Controller.Main"}).state("main.department.share.detail",{url:"/detail?ID",templateUrl:"views/department/share-detail.html",controller:"DepartmentShare.Controller.detail"}).state("main.department.requirementConfirm",{url:"/requirement-confirm",templateUrl:"views/department/requirement-confirm.html",controller:"Department.Requirement.Controller.confirm"}).state("main.department.requirement",{url:"/requirement",templateUrl:"views/department/requirement.html",controller:"Department.Requirement.Controller.Main"}).state("main.department.requirement.publish",{url:"/publish",templateUrl:"views/department/requirement-publish.html"}).state("main.department.requirement.detail",{url:"/detail?ID",templateUrl:"views/department/requirement-detail.html",controller:"Department.Requirement.Controller.detail"}).state("main.department.audit",{url:"/audit",cache:"false",templateUrl:"views/department/audit.html",controller:"Department.Audit.Controller.Main"}).state("main.department.audit.info",{url:"/info/{item:json}",params:{item:null},templateUrl:"views/department/audit-info.html",controller:"Department.Audit.Controller.info"})}]),app.run(["$rootScope",function(e){e.$on("$stateChangeStart",function(e,t,a,n,r){"login"!==t.name&&(sessionStorage.token||(window.location.href="/"))})}]);var Config=angular.module("Config",[]);Config.constant("API",{path:"http://localhost:8080/drrp/api"});var AdminDepartment=angular.module("Admin.Department",["ui.router"]);AdminDepartment.controller("Admin.Department.Controller.Main",["$rootScope","$scope","$stateParams","AdminDepartment.Service.Http","AdminDepartment.Service.Component","$uibModal","$state",function(e,t,a,n,r,o,i){function s(e){n.getDepartmentList(e).then(function(e){t.AdminDepartments=e.data.body})}function l(){n.getDepTotal({}).then(function(e){t.depTotal=e.data.body[0].number,t.Paging.totalItems=t.depTotal})}t.Modal={},t.previousDepNames=[],t.areaNames=[],t.Paging={},t.Paging.maxSize=5,t.Paging.itemsPerPage=10;var d={};d.limit=10,d.skip=0,t.Paging.pageChanged=function(){d.skip=(t.Paging.currentPage-1)*d.limit,s(d)},s(d),l(),n.getDepartmentList().then(function(e){t.AllDepartments=e.data.body}),n.getSysDict({dict_category:"7"}).then(function(e){t.types=e.data.body}),n.getSysDict({dict_category:"9"}).then(function(e){t.areaNames=e.data.body}),t.placeholder={},t.placeholder.dep_sn="必填",t.placeholder.order_by="必填",t.placeholder.dep_name="必填",t.placeholder.dep_short_name="必填",t.placeholder.dep_en_name="必填",t.placeholder.contacts="必填",t.placeholder.contact_phone="必填",t.addDepartmentModal=function(){t.Modal={},t.department={},t.department.dep_en_name="anquanting.png",t.department.parent_id="0",t.department.area_code="c9cf130a-1e2f-11e6-ac02-507b9d1b58bb",t.department.dep_type="aa7772bb-10de-11e6-9b44-507b9d1b58bb";var e=r.popModal(t,"添加","add-department-modal");e.opened.then(function(){t.Modal.TypeArea=function(){if("0"!=t.department.parent_id){var e=_.findIndex(t.AllDepartments,function(e){return e.id==t.department.parent_id});t.department1=t.AllDepartments[e]}},t.Modal.validDepName=function(e){t.validDepName=!1,t.placeholder.dep_name="必填",n.getDepartmentList().then(function(a){for(var n=a.data.body,r=0;r<n.length;r++)n[r].dep_name===e&&(t.validDepName=!0,t.placeholder.dep_name="该部门已存在,请重新输入",t.department.dep_name="")})},t.Modal.validPhone=function(){t.placeholder.contact_phone="必填",t.validPhone=!1;var e=/^((\d{11})|^((\d{7,8})|(\d{4}|\d{3})-(\d{7,8})|(\d{4}|\d{3})-(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1})|(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1}))$)/;e.test(t.department.contact_phone)||null==t.department.contact_phone||(t.validPhone=!0,t.placeholder.contact_phone="电话格式不对",t.department.contact_phone="")}}),e.result.then(function(){n.saveDepartment(t.department).then(function(e){200==e.data.head.status?alert("添加成功"):alert("添加失败"),d.limit=10,d.skip=0,t.Paging.currentPage=0,s(d),l()})})},t.updateDepartment=function(e){t.department=e,t.department.parent_id="0",t.department.area_code="c9cf130a-1e2f-11e6-ac02-507b9d1b58bb",t.department.dep_type="aa7772bb-10de-11e6-9b44-507b9d1b58bb",t.department.dep_en_name="anquanting.png",_.remove(t.AllDepartments,function(t){return t.dep_name==e.dep_name});var a=r.popModal(t,"修改","add-department-modal");a.opened.then(function(){t.Modal.TypeArea=function(){if("0"!=t.department.parent_id){var e=_.findIndex(t.AllDepartments,function(e){return e.id==t.department.parent_id});t.department1=t.AllDepartments[e]}},t.Modal.validDepName=function(e){t.validDepName=!1,t.placeholder.dep_name="必填",n.getDepartmentList().then(function(a){for(var n=a.data.body,r=0;r<n.length;r++)n[r].dep_name===e&&(t.validDepName=!0,t.placeholder.dep_name="该部门已存在,请重新输入",t.department.dep_name="")})},t.Modal.validPhone=function(){t.placeholder.contact_phone="必填",t.validPhone=!1;var e=/^((\d{11})|^((\d{7,8})|(\d{4}|\d{3})-(\d{7,8})|(\d{4}|\d{3})-(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1})|(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1}))$)/;e.test(t.department.contact_phone)||null==t.department.contact_phone||(t.validPhone=!0,t.placeholder.contact_phone="电话格式不对",t.department.contact_phone="")}}),a.result.then(function(){n.updateDepartment(t.department).then(function(e){d.limit=10,d.skip=0,t.Paging.currentPage=0,200==e.data.head.status?alert("修改成功"):alert("修改失败"),s(d)})})},t.deleteDepartment=function(e){var a=confirm("确定要删除吗？");a&&n.deleteDepartment(e).then(function(e){d.limit=10,d.skip=0,t.Paging.currentPage=0,200==e.data.head.status?alert("删除成功"):alert("删除失败！"),i.go("main.admin.department",{},{reload:!0})})},t.searchDepartment=function(){d.limit=10,d.skip=0,d.sysdepname=t.dep_name,null==t.dep_name?(l(),s(d)):n.getDepartmentList(d).then(function(e){e.data.head.total>=1?(t.AdminDepartments=e.data.body,t.depTotal=e.data.head.total,t.Paging.totalItems=t.depTotal):(alert("系统没有查到'"+t.dep_name+"'这个部门，请重新输入"),t.dep_name="",i.go("main.admin.department",{},{reload:!0}))})}}]),AdminDepartment.factory("AdminDepartment.Service.Http",["$http","API",function(e,t){function a(t){return e.get(l+"/sys_dep",{params:t})}function n(){return e.get(l+"/sys_dep/count")}function r(t){return e.post(l+"/sys_dep",{data:t})}function o(t){return e.get(l+"/sys_dict",{params:t})}function i(t){return e.put(l+"/sys_dep",{data:t})}function s(t){return e["delete"](l+"/sys_dep",{data:{id:t.id}})}var l=t.path;return{getDepartmentList:a,getDepTotal:n,saveDepartment:r,getSysDict:o,updateDepartment:i,deleteDepartment:s}}]),AdminDepartment.service("AdminDepartment.Service.Component",["$uibModal","$state",function(e,t){function a(e,t){e.Alerts=[{type:t.type,message:t.message,timeout:1200}],e.CloseAlert=function(t){e.Alerts.splice(t,1)}}function n(a,n,r){a.Modal.type=n;var o=e.open({animation:!0,backdrop:"static",templateUrl:r+".html",scope:a,size:"md"});return a.Modal.confirm=function(e){e&&o.close(a.Modal)},a.Modal.cancel=function(){o.dismiss(),t.go("main.admin.department",{},{reload:!0})},o}return{popAlert:a,popModal:n}}]);var Admin=angular.module("Admin",["ui.router","ngCookies"]);Admin.controller("Admin.Controller.Main",["$cookies","$scope","$stateParams",function(e,t,a){var n=JSON.parse(e.get("User"));"e147f177-1e83-11e6-ac02-507b9d1b58bb"===n.id?t.titleName="用户/部门管理":t.titleName="用户管理"}]);var AdminUser=angular.module("Admin.User",["ui.router","ngCookies"]);AdminUser.controller("Admin.User.Controller.Main",["$cookies","$scope","$q","$stateParams","AdminUser.Service.Http","AdminUser.Service.Component","$uibModal","$state",function(e,t,a,n,r,o,i,s){function l(e){r.getUserList(e).then(function(e){t.users=e.data.body})}function d(){r.getUserTotal({dep_id:u}).then(function(e){if("e147f177-1e83-11e6-ac02-507b9d1b58bb"===c.id){var a=e.data.body[0].number-1;t.UserTotal=a}else t.UserTotal=e.data.body[0].number;t.Paging.totalItems=t.UserTotal})}var c=JSON.parse(e.get("User")),u="e147f177-1e83-11e6-ac02-507b9d1b58bb"===c.id?null:c.dep_id,m="e147f177-1e83-11e6-ac02-507b9d1b58bb"===c.id?null:c.dep_name;t.Paging={},t.Paging.maxSize=5,t.Paging.itemsPerPage=10;var p={};p.limit=10,p.skip=0,p.dep_id="e147f177-1e83-11e6-ac02-507b9d1b58bb"===c.id?null:u,t.Paging.pageChanged=function(){p.skip=(t.Paging.currentPage-1)*p.limit,l(p)},t.Modal={},t.deptList=[],d(),l(p),r.getDepartmentList({dep_name:m}).then(function(e){t.deptList=e.data.body}),t.placeholder={},t.placeholder.name="必填",t.placeholder.password="必填",t.placeholder.password1="必填",t.placeholder.personName="必填",t.placeholder.organization="必填",t.placeholder.organization_code="必填，根据机构名称自动生成",t.placeholder.phone="必填",t.placeholder.email="必填",t.placeholder.remark="",t.addUserModal=function(){t.Modal={},t.sysUser={},t.sysUser.remark="";var e=o.popModal(t,"添加","add-user-modal");e.opened.then(function(){t.Modal.validUser=function(e){t.placeholder.name="必填",t.validUser=!1,r.getUserList({dep_id:u}).then(function(a){for(var n=a.data.body,r=0;r<n.length;r++)n[r].username===e&&(t.validUser=!0,t.placeholder.name="用户名已存在,请重新输入",t.sysUser.username="")})},t.Modal.organization=function(){t.placeholder.organization="必填",t.placeholder.organization_code="必填",t.organization=!1;var e=t.sysUser.organization;e&&r.getUserOrganizationCode({organization:e}).then(function(e){200==e.data.head.status?t.sysUser.organization_code=e.data.body[0].organization_code:(t.placeholder.organization="机构名称不对",t.organization=!0,t.sysUser.organization="",t.placeholder.organization_code="没有相对应的机构编码")})},t.Modal.validPword=function(){t.placeholder.password1="必填",t.validPword=!1,t.sysUser.password!=t.sysUser.password1&&null!=t.sysUser.password1&&(t.validPword=!0,t.placeholder.password1="两次输入的密码不同,请重新输入",t.sysUser.password1="")},t.Modal.validPhone=function(){t.placeholder.phone="必填",t.validPhone=!1;var e=/^((\d{11})|^((\d{7,8})|(\d{4}|\d{3})-(\d{7,8})|(\d{4}|\d{3})-(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1})|(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1}))$)/;e.test(t.sysUser.phone)||null==t.sysUser.phone||(t.validPhone=!0,t.placeholder.phone="电话格式不对",t.sysUser.phone="")},t.Modal.validEmail=function(e){t.placeholder.email="必填",t.validEmail=!1,e&&(t.validEmail=!0,t.placeholder.email="邮箱格式不对",t.sysUser.email="")}}),e.result.then(function(){r.saveUser(t.sysUser).then(function(e){200==e.data.head.status?alert("添加成功"):alert("保存数据库失败"),p.limit=10,p.skip=0,t.Paging.currentPage=0,l(p),d()})})},t.updateUser=function(e){t.sysUser=e,t.sysUser.password1=0,t.sysUser.password=0,t.sysUser.remark=e.remark?e.remark:"";var a=o.popModal(t,"修改","add-user-modal");a.opened.then(function(){t.Modal.validUser=function(e){t.placeholder.name="必填",t.validUser=!1,r.getUserList({dep_id:u}).then(function(a){for(var n=a.data.body,r=0;r<n.length;r++)n[r].username===e&&(t.validUser=!0,t.placeholder.name="用户名已存在,请重新输入",t.sysUser.username="")})},t.Modal.organization=function(){t.placeholder.organization="必填",t.placeholder.organization_code="必填",t.organization=!1;var e=t.sysUser.organization;e&&r.getUserOrganizationCode({organization:e}).then(function(e){200==e.data.head.status?t.sysUser.organization_code=e.data.body[0].organization_code:(t.placeholder.organization="机构名称不对",t.organization=!0,t.sysUser.organization="",t.placeholder.organization_code="没有相对应的机构编码")})},t.Modal.validPhone=function(){t.placeholder.phone="必填",t.validPhone=!1;var e=/^((\d{11})|^((\d{7,8})|(\d{4}|\d{3})-(\d{7,8})|(\d{4}|\d{3})-(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1})|(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1}))$)/;e.test(t.sysUser.phone)||null==t.sysUser.phone||(t.validPhone=!0,t.placeholder.phone="电话格式不对",t.sysUser.phone="")},t.Modal.validEmail=function(e){t.placeholder.email="必填",t.validEmail=!1,e&&(t.validEmail=!0,t.placeholder.email="邮箱格式不对",t.sysUser.email="")}}),a.result.then(function(){r.updateUser(t.sysUser).then(function(e){p.limit=10,p.skip=0,t.Paging.currentPage=0,200==e.data.head.status?alert("修改成功"):alert("修改失败"),l(p)})})},t.deleteUser=function(e){if(e.id!=c.id){var a=confirm("确定要删除吗？");a&&r.deleteUser(e).then(function(e){p.limit=10,p.skip=0,t.Paging.currentPage=0,200==e.data.head.status?(alert("删除成功"),d(),l(p)):alert("删除失败！"),s.go("main.admin.user",{},{reload:!0})})}else alert("当前登录用户不能删除！")},t.Password=function(e){t.placeholder.password_1="必填",t.placeholder.password_2="必填",t.placeholder.password_3="必填";var a=0;a=e.id,t.Modal.password_pre="",t.Modal.p2="",t.Modal.password="",t.password_1=!1,t.password_2=!1,t.password_3=!1;var n=o.popModal(t,"密码","update-password-modal");n.opened.then(function(){t.Modal.validPword1=function(){t.password_1=!1,t.placeholder.password_1="必填",r.validatePassword({id:a,password:t.Modal.password_pre}).then(function(e){0==e.data.head.total&&(t.password_1=!0,t.placeholder.password_1="原密码不对,请重新输入",t.Modal.password_pre="")})},t.Modal.validPword=function(){t.password_3=!1,t.placeholder.password_3="必填",t.Modal.p2!=t.Modal.password&&(t.password_3=!0,t.placeholder.password_3="两次输入的密码不同,请重新输入",t.Modal.password="")}}),n.result.then(function(){r.UpdatePassword({id:a,password:t.Modal.password}).then(function(e){200==e.data.head.status?alert("修改成功"):alert("修改失败"),p.limit=10,p.skip=0,t.Paging.currentPage=0,l(p),d()})})},t.searchUser=function(){p.limit=10,p.skip=0,p.dep_id=u,p.sysusername=t.username,null==t.username?(d(),l(p)):r.getUserList(p).then(function(e){e.data.head.total>=1?(t.users=e.data.body,t.UserTotal=e.data.head.total,t.Paging.totalItems=t.UserTotal):(alert("系统没有查到'"+t.username+"'这个用户名，请重新输入"),s.go("main.admin.user",{},{reload:!0}))})}}]),AdminUser.factory("AdminUser.Service.Http",["$http","API",function(e,t){function a(t){return e.get(u+"/sys_user/organization_code",{params:t})}function n(t){return e.get(u+"/sys_user",{params:t})}function r(t){return e.get(u+"/sys_user/count",{params:t})}function o(t){return e.get(u+"/sys_dep",{params:t})}function i(t){return e.post(u+"/sys_user",{data:t})}function s(t){return e.put(u+"/sys_user",{data:t})}function l(t){return e["delete"](u+"/sys_user",{data:{id:t.id}})}function d(t){return e.get(u+"/sys_user/password",{params:t})}function c(t){return e.put(u+"/sys_user/password",{data:t})}var u=t.path;return{getUserOrganizationCode:a,getUserList:n,saveUser:i,getDepartmentList:o,updateUser:s,deleteUser:l,getUserTotal:r,validatePassword:d,UpdatePassword:c}}]),AdminUser.service("AdminUser.Service.Component",["$uibModal","$state",function(e,t){function a(e,t){e.Alerts=[{type:t.type,message:t.message,timeout:1200}],e.CloseAlert=function(t){e.Alerts.splice(t,1)}}function n(a,n,r){a.Modal.type=n;var o=e.open({animation:!0,backdrop:"static",templateUrl:r+".html",scope:a,size:"md"});return a.Modal.confirm=function(e){e&&o.close(a.Modal)},a.Modal.cancel=function(){o.dismiss(),t.go("main.admin.user",{},{reload:!0})},o}return{popAlert:a,popModal:n}}]);var Dashboard=angular.module("Dashboard",["ui.router","ui.bootstrap"]);Dashboard.controller("Dashboard.Controller.Main",["$scope","Dashboard.Service.Http",function(e,t){t.getDepartments().then(function(t){200==t.data.head.status&&(e.Bureaus=t.data.body)}),e.DataquotaSummary=t.getDataquotaSummary(),e.DataRequirementSummary=t.getDataRequirementSummary(),t.getDataquotaSummary().then(function(t){e.SummaryDataQuota=t.data.body[0]}),t.getDataRequirementSummary().then(function(t){e.SummaryRequirement=t.data.body[0]}),t.getDataQuotaNew({skip:0,limit:7}).then(function(t){200==t.data.head.status&&(e.NewIndicators=t.data.body)}),t.getDataRequirementNew({skip:0,limit:7}).then(function(t){200==t.data.head.status&&(e.Requirements=t.data.body)}),e.select=function(a){e.departmentID={resource_dep_id:a},t.getDataQuota({skip:0,limit:5,dep_name:a}).then(function(t){e.followDepIndicators=t.data.body[0].results})},t.getUserDep().then(function(t){return 200===t.data.head.status&&0!==t.data.body.length?(e.followDeps=t.data.body,t.data.body[0].id):0}).then(function(a){t.getDataQuota({skip:0,limit:5,dep_name:a}).then(function(t){e.followDepIndicators=t.data.body[0].results})})}]),Dashboard.factory("Dashboard.Service.Http",["$http","API",function(e,t){function a(t){return e.get(d+"/data_resource/new",{params:t})}function n(t){return e.get(d+"/data_requiement/new",{params:t})}function r(){return e.get(d+"/sys_dep")}function o(){return e.get(d+"/data_resource/summary")}function i(){return e.get(d+"/data_requiement/summary")}function s(t){return e.get(d+"/department",{params:t})}function l(t){return e.get(d+"/data_quota",{params:t})}var d=t.path;return{getDataQuotaNew:a,getDataRequirementNew:n,getDepartments:r,getDataquotaSummary:o,getDataRequirementSummary:i,getUserDep:s,getDataQuota:l}}]),Dashboard.directive("wiservDataQuotaOverviewChart",[function(){return{restrict:"AE",template:"<div style='width:300;height:155px;position:relative;top:-8px'></div>",link:function(e,t,a){e.DataquotaSummary.then(function(e){if(200==e.data.head.status){var a=e.data.body[0],n=echarts.init(t.find("div")[0]),r={tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},series:[{name:"资源提供部门",type:"pie",radius:[0,"40%"],label:{normal:{position:"inner",textStyle:{color:"#FFAD38"}}},labelLine:{normal:{show:!1}},data:[{value:a.dep_resource,name:"资源提供部门"},{value:a.month_increment_dpet_resource,name:"本月新增",selected:!0}]},{name:"资源总数",type:"pie",radius:["60%","75%"],data:[{value:a.total_resource,name:"资源总数"},{value:a.month_increment_resource,name:"本月新增",selected:!0}]}]};n.setOption(r)}})}}}]),Dashboard.directive("wiservRequirementOverviewChart",[function(){return{restrict:"AE",template:"<div style='width:300;height:155px;position:relative;top:-8px'></div>",link:function(e,t,a){e.DataRequirementSummary.then(function(e){if(200==e.data.head.status){var a=e.data.body[0],n=echarts.init(t.find("div")[0]),r={tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},series:[{name:"需求涉及部门",type:"pie",radius:[0,"40%"],label:{normal:{position:"inner",textStyle:{color:"#FFAD38"}}},labelLine:{normal:{show:!1}},data:[{value:a.department_number,name:"需求涉及部门"},{value:a.department_number_inc,name:"本月新增",selected:!0}]},{name:"需求总数",type:"pie",radius:["60%","75%"],data:[{value:a.requiement_number,name:"需求总数"},{value:a.requiement_number_inc,name:"本月新增",selected:!0}]}]};n.setOption(r)}})}}}]),Dashboard.directive("wiservStatisticChart",[function(){return{restrict:"AE",template:"<div style='width:100%;height:240px;'></div>",link:function(e,t,a){e.QInventoryStatistic.then(function(e){var a=e.data.body[0],n=e.data.body[1],r=e.data.body[2],o=echarts.init(t.find("div")[0]),i={tooltip:{trigger:"axis"},legend:{data:["资源","需求"]},xAxis:[{type:"category",name:"数量",data:a.DEPARTMENT}],yAxis:[{type:"value",name:"单位",min:0,max:30,interval:30,axisLabel:{formatter:"{value} 个"}}],series:[{name:"资源",type:"bar",data:n.INVENTORY},{name:"需求",type:"bar",data:r.REQUIREMENT}]};o.setOption(i)})}}}]);var Login=angular.module("Login",["ui.router","ngCookies"]);Login.controller("Login.Controller.Main",["$rootScope","$cookies","$scope","$state","Login.Service.Http",function(e,t,a,n,r){sessionStorage.message&&(a.alerts=[{type:"danger",msg:sessionStorage.message}],a.closeAlert=function(e){a.alerts.splice(e,1)},sessionStorage.removeItem("message")),a.Login={},a.Login.submit=function(o){if(a.loginSubmitted=!1,o){var i=a.Login.username,s=a.Login.password;r.login({username:i,password:s}).then(function(r){var o=r.data.body[0];e.User=o,t.put("User",JSON.stringify(o)),console.log(JSON.stringify(o));var i=r.data.head.token;i&&(sessionStorage.token=i),200==r.data.head.status?n.go("main.dashboard"):a.loginError=!0})}else a.loginSubmitted=!0}}]),Login.factory("Login.Service.Http",["$http","API",function(e,t){function a(t){return e.get(n+"/login",{params:t})}var n=t.path;return{login:a}}]);var Main=angular.module("Main",["ui.router","ngCookies"]);Main.controller("Main.Controller.Main",["$scope","$cookies",function(e,t){e.User=JSON.parse(t.get("User"))}]);var DataQuotaDetail=angular.module("DataQuotaDetail",["ui.router"]);DataQuotaDetail.controller("DataQuotaDetail.Controller.Main",["$scope","$state","DataQuotaDetail.Service.Http","$stateParams",function(e,t,a,n){a.getDataQuotaDetailByDepID(n).then(function(t){e.DataQuotaDetail=t.data.body[0]}),a.getDataQuotaExampleByDepID({resource_id:n.resource_id}).then(function(t){e.DataQuotaExample=t.data.body})}]),DataQuotaDetail.factory("DataQuotaDetail.Service.Http",["$http","API",function(e,t){function a(t){return e.get(r+"/info_resource_detail",{params:t})}function n(t){return e.get(r+"/info_item_detail",{params:t})}var r=t.path;return{getDataQuotaDetailByDepID:a,getDataQuotaExampleByDepID:n}}]);var DataQuotaList=angular.module("DataQuotaList",["ui.router"]);DataQuotaList.controller("DataQuotaList.Controller.Main",["$scope","$state","DataQuotaList.Service.Http","$stateParams",function(e,t,a,n){function r(t){a.getDataQuota(t).then(function(t){e.DataQuotas=t.data.body[0].results,e.DataQuotasTotal=t.data.body[0].count,e.Paging.totalItems=t.data.body[0].count})}function o(e){var t={};t=""===i.dep_name?l:_.assign(t,i,l),_.assign(t,e),r(t)}var i={resource_dep_id:n.resource_dep_id},s={dep_name:n.dep_name};e.currentDep=s.dep_name;var l={limit:10,skip:0};e.Paging={},e.Paging.currentPage=1,e.Paging.itemsPerPage=10,e.Paging.pageChanged=function(){var t={};_.assign(t,i,{limit:10,skip:10*(e.Paging.currentPage-1)}),r(t)},function(){e.resourceFormatActiveAll=e.ShareLevelActiveAll=e.openToSocietyActiveAll=e.ShareFrequencyActiveAll=e.DataLevelActiveAll=e.isScretActiveAll="active";var t={};t=""===i?l:_.assign(t,i,l),r(t)}(),e.Retrieval=function(){var t={},a={resource_name:e.TargetDataQuotaName};""===i?_.assign(t,l,a):_.assign(t,i,l,a),r(t)},e.DataQuotaApplyInfo=function(t){a.getDataQuotaApplyInfo({info_resource_id:t}).then(function(){alert("申请查看成功");var t={};_.assign(t,{limit:10,skip:10*(e.Paging.currentPage-1)}),r(t)})};var d=1,c=2,u=3,m=11,p=14,f=5;a.getSystemDictByCatagory({dict_category:m}).then(function(t){e.resourceFormats=t.data.body}),a.getSystemDictByCatagory({dict_category:p}).then(function(t){e.openToSocietys=t.data.body}),a.getSystemDictByCatagory({dict_category:f}).then(function(t){e.isScrets=t.data.body}),a.getSystemDictByCatagory({dict_category:u}).then(function(t){e.ShareLevels=t.data.body}),a.getSystemDictByCatagory({dict_category:d}).then(function(t){e.ShareFrequencys=t.data.body}),a.getSystemDictByCatagory({dict_category:c}).then(function(t){e.DataLevels=t.data.body});var g={};e.resourceFormatFilter=function(t,a){e.resourceFormatActive=[],e.resourceFormatActiveAll="",e.resourceFormatActive[a]="active",g.re_format=t,"ALL"===t?(delete g.re_format,e.resourceFormatActiveAll="active",o(g)):o(g)},e.ShareLevelFilter=function(t,a){e.ShareLevelActive=[],e.ShareLevelActiveAll="",e.ShareLevelActive[a]="active",g.share_level=t,"ALL"===t?(delete g.share_level,e.ShareLevelActiveAll="active",o(g)):o(g)},e.openToSocietyFilter=function(t,a){e.openToSocietyActive=[],e.openToSocietyActiveAll="",e.openToSocietyActive[a]="active",g.social_open_flag=t,"ALL"===t?(delete g.social_open_flag,e.openToSocietyActiveAll="active",o(g)):o(g)},g.update_period=[],e.ShareFrequencyActive=[],e.ShareFrequencyFilter=function(t,a){"ALL"===t?(g.update_period=[],e.ShareFrequencyActiveAll="active",e.ShareFrequencyActive=[],o(g)):(e.ShareFrequencyActiveAll="","active"===e.ShareFrequencyActive[a]?e.ShareFrequencyActive[a]="":e.ShareFrequencyActive[a]="active",g.update_period.push(t),o(g))},g.area_level=[],e.DataLevelActive=[],e.DataLevelFilter=function(t,a){"ALL"===t?(g.area_level=[],e.DataLevelActiveAll="active",e.DataLevelActive=[],o(g)):(e.DataLevelActiveAll="","active"===e.DataLevelActive[a]?e.DataLevelActive[a]="":e.DataLevelActive[a]="active",g.area_level.push(t),o(g))},e.isScretFilter=function(t,a){e.isScretActive=[],e.isScretActiveAll="",e.isScretActive[a]="active",g.issecret=t,"ALL"===t?(delete g.issecret,e.isScretActiveAll="active",o(g)):o(g)}}]),DataQuotaList.factory("DataQuotaList.Service.Http",["$http","API",function(e,t){function a(t){return e.get(o+"/sys_dict",{params:t})}function n(t){return e.get(o+"/resource/sys_dict",{params:t})}function r(t){return e.post(o+"/info_resource_apply_info",{data:t})}var o=t.path;return{getSystemDictByCatagory:a,getDataQuotaApplyInfo:r,getDataQuota:n}}]);var DataQuota=angular.module("DataQuota",["ui.router"]);DataQuota.controller("DataQuota.Controller.Main",["$scope","$state","DataQuota.Service.Http",function(e,t,a){window.scrollTo(0,0),e.treeOptions={nodeChildren:"nodes",dirSelectable:!1,injectClasses:{ul:"a1",li:"a2",liSelected:"a7",iExpanded:"a3",iCollapsed:"a4",iLeaf:"a5",label:"a6",labelSelected:"a8"}},a.menu().then(function(t){200===t.data.head.status&&(e.list=t.data.body)})}]),DataQuota.factory("DataQuota.Service.Http",["$http","API",function(e,t){function a(t){return e.get(n+"/menu",{params:t})}var n=t.path;return{menu:a}}]);var Audit=angular.module("Department.Audit",["ui.router"]);Audit.controller("Department.Audit.Controller.Main",["$scope","$q","Department.Audit.Service.Http",function(e,t,a){function n(){e.auditPromise=a.getAuditList(r).then(function(t){e.auditList=t.data.body[0].results,e.Paging.totalItems=t.data.body[0].count})}e.InfoResource={},e.Paging={},e.Paging.maxSize=5,e.Paging.itemsPerPage=10;var r={};r.limit=10,r.skip=0,e.Paging.pageChanged=function(){r.skip=(e.Paging.currentPage-1)*r.limit,n(r)},n(),e.searchInfoResourceByName=function(){r.resource_name=e.InfoResource.resource_name_filter,r.limit=10,r.skip=0,n()}}]),Audit.controller("Department.Audit.Controller.info",["$scope","$state","$q","Department.Audit.Service.Http","$stateParams",function(e,t,a,n,r){e.TabItemShow=!0,e.TabRequireShow=!0,e.AuditInfo={},e.AuditInfo.audit_opinion="",console.log(r.item),e.InfoResourceDetail=r.item,e.InfoItemShow=!1,n.getInfoItemList({resource_id:e.InfoResourceDetail.id}).then(function(t){0==t.data.body.length?e.InfoItemShow=!1:(e.InfoItemShow=!0,e.InfoItems=t.data.body)}),e.submitAudit=function(){return console.log(e.AuditInfo.audit_status),e.AuditInfo.audit_status?(e.AuditInfo.audit_id=r.item.audit_id,void n.updateAuditDetail(e.AuditInfo).then(function(e){200==e.data.head.status?(alert("审核成功"),t.go("main.department.audit",{},{reload:!0})):alert("审核失败")})):void(e.auditError=!0)}}]),Audit.factory("Department.Audit.Service.Http",["$http","$q","API",function(e,t,a){function n(t){return e.get(l+"/openinfo_resourcelist",{params:t})}function r(t){return e.get(l+"/data_quota_detail",{params:t})}function o(t){return e.put(l+"/openinfo_resourceok",{data:t})}function i(t){return e.get(l+"/requiement_detail",{params:t})}function s(t){return e.get(l+"/item_detail",{params:t})}var l=a.path;return{getAuditList:n,getInfoResourceDetail:r,updateAuditDetail:o,getQuotaRequirement:i,getInfoItemList:s}}]);var DInventory=angular.module("Department.Inventory",["ui.router","ngCookies","cgBusy"]);DInventory.controller("Department.Inventory.Controller.Main",["$cookies","$scope","$q","Department.Inventory.Service.Http",function(e,t,a,n){function r(e){t.promise=n.getDepartInfoResList(e).then(function(e){console.log(e),t.infoResourceList=e.data.body[0].results,t.Paging.totalItems=e.data.body[0].count})}var o=1,i=2,s=3,l=5,d=11,c=14,u=JSON.parse(e.get("User"));u.dep_id;t.DepartInfoResource={},t.Paging={},t.Paging.maxSize=5,t.Paging.itemsPerPage=10;var m={};m.limit=10,m.skip=0,n.getSystemDictByCatagory({dict_category:l}).then(function(e){t.secretFlagList=e.data.body}),n.getSystemDictByCatagory({dict_category:o}).then(function(e){t.shareFrequencyList=e.data.body}),n.getSystemDictByCatagory({dict_category:s}).then(function(e){t.shareLevelList=e.data.body}),n.getSystemDictByCatagory({dict_category:d}).then(function(e){t.resourceFormatList=e.data.body}),n.getSystemDictByCatagory({dict_category:i}).then(function(e){t.dataLevelList=e.data.body}),n.getSystemDictByCatagory({dict_category:c}).then(function(e){t.socialOpenList=e.data.body}),t.Paging.pageChanged=function(){m.skip=(t.Paging.currentPage-1)*m.limit,r(m)},r(m),t.getResFormatAll=function(){t.resFormatMainSelection=[],m.re_format=null,m.limit=10,m.skip=0,r(m)},t.getShareLevelAll=function(){t.shareLvMainSelection=[],m.share_level=null,m.limit=10,m.skip=0,r(m)},t.getSocialOpenAll=function(){t.socialOpenMainSelection=[],m.social_open_flag=null,m.limit=10,m.skip=0,r(m)},t.getShareFreqAll=function(){t.shareFreqSelection=[],m.update_period=null,m.limit=10,m.skip=0,r(m)},t.getSecretFlagAll=function(){t.secretFlagMainSelection=[],m.issecret=null,m.limit=10,m.skip=0,r(m)},t.resFormatMainSelection=[],t.getInfoResourceByResFormat=function(e){var a=t.shareFreqSelection.indexOf(e.id);a>-1?t.resFormatMainSelection=[]:t.resFormatMainSelection=e.id,m.re_format=t.resFormatMainSelection,m.limit=10,m.skip=0,r(m)},t.shareFreqSelection=[],t.getInfoResourceListBySF=function(e){var a=t.shareFreqSelection.indexOf(e.id);a>-1?t.shareFreqSelection=[]:t.shareFreqSelection=e.id,m.update_period=t.shareFreqSelection,m.limit=10,m.skip=0,r(m)},t.shareLvMainSelection=[],t.getInfoResourceListBySl=function(e){var a=t.shareLvMainSelection.indexOf(e.id);a>-1?t.shareLvMainSelection=[]:t.shareLvMainSelection=e.id,m.share_level=t.shareLvMainSelection,m.limit=10,m.skip=0,r(m)},t.socialOpenMainSelection=[],t.getInfoResourceListBySO=function(e){var a=t.socialOpenMainSelection.indexOf(e.dict_code);a>-1?t.socialOpenMainSelection=[]:t.socialOpenMainSelection=e.dict_code,m.social_open_flag=t.socialOpenMainSelection,
m.limit=10,m.skip=0,r(m)},t.secretFlagMainSelection=[],t.getInfoResourceListBySecFlag=function(e){var a=t.secretFlagMainSelection.indexOf(e.id);a>-1?t.secretFlagMainSelection=[]:t.secretFlagMainSelection=e.id,m.issecret=t.secretFlagMainSelection,m.limit=10,m.skip=0,r(m)},t.getSpatialAll=function(){t.areaMainSelection=[],m.area_level=null,m.limit=10,m.skip=0,r(m)},t.areaMainSelection=[],t.getInfoResourceListByAP=function(e){var a=t.areaMainSelection.indexOf(e.id);a>-1?t.areaMainSelection.splice(a,1):t.areaMainSelection.push(e.id),m.area_level=t.areaMainSelection,m.limit=10,m.skip=0,r(m)},t.searchDeptInfoResourceByName=function(){m.resource_name=t.DepartInfoResource.resource_name_filter,m.limit=10,m.skip=0,r(m)},t.deleteInfoResource=function(e){var t=confirm("确定删除本条信息资源？删除后将不可恢复。");t&&n.deleteInfoResource({resourceid:e}).then(function(e){200==e.data.head.status?(alert("删除成功！"),r(m)):alert("删除失败")})}}]),DInventory.controller("Department.Inventory.Controller.detail",["$scope","$q","Department.Inventory.Service.Http","$stateParams","$state",function(e,t,a,n,r){console.log(n.item),e.InfoResourceDetail=n.item,e.InfoItemShow=!1,a.getInfoItemList({resource_id:e.InfoResourceDetail.id}).then(function(t){0==t.data.body.length?e.InfoItemShow=!1:(e.InfoItemShow=!0,e.InfoItems=t.data.body)})}]),DInventory.controller("Department.Inventory.Controller.publish",["$cookies","$scope","$stateParams","$state","$q","$uibModal","Department.Inventory.Service.Component","Department.Inventory.Service.Http",function(e,t,a,n,r,o,i,s){var l=10,d=12,c=13,u=15,m="250375bd-02f0-11e6-a52a-5cf9dd40ad7e",p="2501e32c-02f0-11e6-a52a-5cf9dd40ad7e",f="aaee8194-2614-11e6-a9e9-507b9d1b58bb",g="ab11fdd4-2614-11e6-a9e9-507b9d1b58bb",h="d8d61ff3-2616-11e6-a9e9-507b9d1b58bb",y=JSON.parse(e.get("User")),v=y.dep_id;t.DEP_NAME=y.dep_name,t.ORG_NAME=y.organization,t.ORG_CODE=y.organization_code,t.InfoResource={},t.InfoResource.alias="",t.InfoResource.rel_category="",t.InfoResource.secret_flag="",t.InfoResource.meter_unit="",t.InfoResource.calculate_method="",t.InfoResource.resource_format_other="",t.InfoResource.share_method_other="",t.InfoResource.social_open_limit="",t.InfoResource.linkman="",t.InfoResource.contact_phone="",t.ResourceItemList=[],t.ResourceItemConfigList=[],t.resNameExist=!1,t.checkResName=function(){t.InfoResource.resource_name&&""!=t.InfoResource.resource_name&&s.checkResName({resource_name:t.InfoResource.resource_name}).then(function(e){"true"==e.data.body[0].isexists?t.resNameExist=!0:t.resNameExist=!1})},t.parent={},t.parent.itemNameExist=!1,t.checkItemName=function(){t.ResourceItem.item_name&&""!=t.ResourceItem.item_name&&s.checkItemName({item_name:t.ResourceItem.item_name}).then(function(e){"true"==e.data.body[0].isexists?t.parent.itemNameExist=!0:t.parent.itemNameExist=!1})},s.getDepartmentList().then(function(e){t.deptList=e.data.body;_.remove(t.deptList,function(e){return e.id==v})}),s.getSystemDictByCatagory({dict_category:l}).then(function(e){t.resourceCategoryList=e.data.body}),s.getSystemDictByCatagory({dict_category:d}).then(function(e){t.shareTypeList=e.data.body}),s.getSystemDictByCatagory({dict_category:c}).then(function(e){t.shareMethodList=e.data.body}),s.getSystemDictByCatagory({dict_category:u}).then(function(e){t.itemTypeList=e.data.body}),t.close=function(e){n.go("main.department.inventory",{},{reload:!0})},t.addInfoResource=function(e){t.submitted=!0;var a={},r=[],o=[];if(t.resNameExist&&(e=!1),0!=t.shareFreqSelection.length||t.resItemAddBtn||(e=!1),t.resItemAddBtn&&0==t.ResourceItemList.length&&(e=!1),e){a.InfoResource=t.InfoResource,_(t.dataLevelSelection).forEach(function(e){var a={};a.InfoResourceId=t.InfoResource.resource_name,a.sys_dict_id=e,r.push(a)}),_(t.shareFreqSelection).forEach(function(e){var a={};a.InfoResourceId=t.InfoResource.resource_name,a.sys_dict_id=e,a.obj_type=1,r.push(a)});var i=_.map(t.outputDeptList,"id");_(i).forEach(function(e){var a={};a.InfoResourceId=t.InfoResource.resource_name,a.apply_dep=e,o.push(a)}),_(t.ResourceItemList).forEach(function(e,a){console.log(a),e.item_ord=a,e.InfoResourceId=t.InfoResource.resource_name,console.log(t.ResourceItemList)}),a.InfoResource_RelationConfig=r,a.InfoResourceApplyInfo=o,a.InfoItem_RelationConfig=t.ResourceItemConfigList,a.InfoItem=t.ResourceItemList,console.log(a),s.saveInfoResource(a).then(function(e){console.log(e.data),200==e.data.head.status?(t.Modal={},n.go("main.department.inventory",{},{reload:!0})):alert("保存失败")})}},console.log(a.item),t.resItemUpdateBtn=!1,a.item&&(t.InfoResource=a.item,s.getResourceAreaLevel({resource_id:t.InfoResource.id}).then(function(e){t.dataLevelSelection=e.data.body[0].id}),s.getResourceUpdatePeriod({resource_id:t.InfoResource.id}).then(function(e){t.shareFreqSelection=e.data.body[0].id}),s.getResourceShareDeps({resource_id:t.InfoResource.id}).then(function(e){var a=e.data.body[0].id;a.length>0&&(t.depShow=!0),_(t.deptList).forEach(function(e){_(a).forEach(function(a){e.id==a&&(e.ticked=!0,t.outputDeptList.push(e))})})}),f==t.InfoResource.resource_format&&(t.resItemUpdateBtn=!0)),t.updateInfoResource=function(e){t.submitted=!0;var a={},r=[],o=[];if(t.resNameExist&&(e=!1),0!=t.shareFreqSelection.length||t.resItemUpdateBtn||(e=!1),t.resItemAddBtn&&0==t.ResourceItemList.length&&(e=!1),e){a.InfoResource=t.InfoResource,_(t.dataLevelSelection).forEach(function(e){var a={};a.InfoResourceId=t.InfoResource.id,a.sys_dict_id=e,r.push(a)}),_(t.shareFreqSelection).forEach(function(e){var a={};a.InfoResourceId=t.InfoResource.id,a.sys_dict_id=e,a.obj_type=1,r.push(a)});var i=_.map(t.outputDeptList,"id");_(i).forEach(function(e){var a={};a.InfoResourceId=t.InfoResource.id,a.apply_dep=e,o.push(a)}),_(t.ResourceItemList).forEach(function(e,a){console.log(a),e.item_ord=a,e.InfoResourceId=t.InfoResource.id,console.log(t.ResourceItemList)}),a.InfoResource_RelationConfig=r,a.InfoResourceApplyInfo=o,a.InfoItem_RelationConfig=t.ResourceItemConfigList,a.InfoItem=t.ResourceItemList,console.log(a),s.updateInfoResource(a).then(function(e){console.log(e.data),200==e.data.head.status?(alert("保存成功！"),t.Modal={},n.go("main.department.inventory",{},{reload:!0})):alert("保存失败"),t.dataLevelSelection=[],t.shareFreqSelection=[]})}},t.editItems=function(e){s.getInfoItemList({resource_id:e}).then(function(e){t.ResourceItemList=e.data.body,_(t.ResourceItemList).forEach(function(e){var a={};a.InfoItemId=e.item_name;var n=[];_(e.config).forEach(function(e){a.sys_dict_id=e.id,n.push(e.dict_name),t.ResourceItemConfigList.push(a)}),e.update_period_name=n}),console.log(t.ResourceItemConfigList)}),t.ResItemListShow=!0},t.addResourceItem=function(e){t.shareFreqEmpty=!1,t.Modal={},t.itemAdded=!1,t.ResourceItem={},t.ResourceItem.meter_unit="",t.ResourceItem.calculate_method="",t.ResourceItem.shareFreqItemSelection=[],t.ResourceItem.shareFreqItemObjSelection=[],t.parent.itemNameExist=!1,t.data={},t.data.item_type=t.itemTypeList[0],t.data.secret_flag=t.secretFlagList[0],t.$watch("data.item_type",function(e){t.ResourceItem.item_type=e.id,t.ResourceItem.item_type_name=e.dict_name}),t.$watch("data.secret_flag",function(e){t.ResourceItem.secret_flag=e.id,t.ResourceItem.secret_flag_name=e.dict_name}),i.popModal(t,"Department.Inventory.Controller.publish","新增","item-add-modal").result.then(function(a){console.log(t.ResourceItem),t.itemAdded=!1,console.log(e);var n=[];_(t.ResourceItem.shareFreqItemObjSelection).forEach(function(e){var a={};a.InfoItemId=t.ResourceItem.item_name,a.sys_dict_id=e.id,t.ResourceItemConfigList.push(a),n.push(e.dict_name)}),t.ResourceItem.config=t.ResourceItem.shareFreqItemObjSelection,t.ResourceItem.update_period_name=n,t.ResourceItemList.push(t.ResourceItem),console.log(t.ResourceItemList)})},t.updateItem=function(e){console.log(e),t.Modal={},t.itemUpdated=!1,t.ResourceItem=e,t.ResourceItem.shareFreqItemSelection=_.map(e.config,"id"),t.ResourceItem.shareFreqItemObjSelection=e.config,t.shareFreqEmpty=!1,t.data={},_(t.secretFlagList).forEach(function(a){e.secret_flag==a.id&&(t.data.secret_flag=a)}),_(t.itemTypeList).forEach(function(a){e.item_type==a.id&&(t.data.item_type=angular.copy(a),console.log(t.data.item_type))}),t.$watch("data.item_type",function(e){console.log(t.data.item_type),e&&(t.ResourceItem.item_type=e.id,t.ResourceItem.item_type_name=e.dict_name)}),t.$watch("data.secret_flag",function(e){console.log(e),t.ResourceItem.secret_flag=e.id,t.ResourceItem.secret_flag_name=e.dict_name}),i.popModal(t,"Department.Inventory.Controller.publish","修改","item-add-modal").result.then(function(e){t.itemUpdated=!1;var a=[];_.remove(t.ResourceItemConfigList,function(e){return e.InfoItemId==t.ResourceItem.item_name}),_(t.ResourceItem.shareFreqItemObjSelection).forEach(function(e){var n={};n.InfoItemId=t.ResourceItem.item_name,n.sys_dict_id=e.id,t.ResourceItemConfigList.push(n),a.push(e.dict_name)}),t.ResourceItem.update_period_name=a,console.log(t.ResourceItemList)})},t.deleteItem=function(e){var a=confirm("确定删除本条信息项？");console.log(e),a&&e>-1&&t.ResourceItemList.splice(e,1)},t.depShow=!1,t.showHideDeps=function(e){p!=t.InfoResource.share_level?(m==t.InfoResource.share_level?(t.depShow=!0,t.socialOpenFlag=!1):(t.depShow=!1,t.socialOpenFlag=!0),t.InfoResource.social_open_flag=0):t.InfoResource.social_open_flag=1},t.shareMethodOtherShow=!1,t.showHideShareMethodOther=function(){h==t.InfoResource.share_method?t.shareMethodOtherShow=!0:t.shareMethodOtherShow=!1},t.resItemAddBtn=!1,t.resFormatOtherShow=!1,t.showHideResAddBtn=function(){t.resFormatOtherShow=!1,f==t.InfoResource.resource_format?(a.item?t.resItemUpdateBtn=!0:t.resItemAddBtn=!0,t.resFormatOtherShow=!1,t.shareFreqSelection=[],t.InfoResource.secret_flag="",t.InfoResource.meter_unit="",t.InfoResource.calculate_method=""):g==t.InfoResource.resource_format?(t.resFormatOtherShow=!0,t.resItemAddBtn=!1,t.resItemUpdateBtn=!1):(t.resItemAddBtn=!1,t.resFormatOtherShow=!1,t.resItemUpdateBtn=!1)},t.dataLevelSelection=[],t.toggleDataLevelSelection=function(e){var a=t.dataLevelSelection.indexOf(e.id);a>-1?t.dataLevelSelection.splice(a,1):t.dataLevelSelection.push(e.id)},t.shareFreqSelection=[],t.toggleShareFreqSelection=function(e){var a=t.shareFreqSelection.indexOf(e.id);a>-1?t.shareFreqSelection.splice(a,1):t.shareFreqSelection.push(e.id)},t.toggleShareFreqItemSelection=function(e){var a=t.ResourceItem.shareFreqItemSelection.indexOf(e.id);console.log(a),a>-1?(t.ResourceItem.shareFreqItemSelection.splice(a,1),t.ResourceItem.shareFreqItemObjSelection.splice(a,1)):(t.ResourceItem.shareFreqItemSelection.push(e.id),t.ResourceItem.shareFreqItemObjSelection.push(e)),console.log(t.ResourceItem.shareFreqItemObjSelection)}}]),DInventory.factory("Department.Inventory.Service.Http",["$http","$q","API",function(e,t,a){function n(){return e.get(_+"/sys_dep")}function r(t){return e.get(_+"/info_resource_list",{params:t})}function o(t){return e.get(_+"/data_quota_detail",{params:t})}function i(t){return e.post(_+"/info_resource",{data:t})}function s(t){return e.put(_+"/info_resource",{data:t})}function l(t){return e.get(_+"/allitem_detail",{params:t})}function d(t){return e.get(_+"/sys_dict",{params:t})}function c(t){return e["delete"](_+"/info_resource",{data:t})}function u(t){return e.get(_+"/resource_area_level",{params:t})}function m(t){return e.get(_+"/resource_update_period",{params:t})}function p(t){return e.get(_+"/resource_share_dep",{params:t})}function f(t){return e.put(_+"/info_item",{data:t})}function g(t){return e.get(_+"/item_update_period",{params:t})}function h(t){return e.get(_+"/info_resource_name",{params:t})}function y(t){return e.get(_+"/info_item_name",{params:t})}var _=a.path;return{saveInfoResource:i,getDepartmentList:n,getDepartInfoResList:r,getInfoResourceDetail:o,getSystemDictByCatagory:d,deleteInfoResource:c,updateInfoResource:s,getInfoItemList:l,getResourceAreaLevel:u,getResourceUpdatePeriod:m,getResourceShareDeps:p,updateInfoItem:f,getItemUpdatePeriod:g,checkResName:h,checkItemName:y}}]),DInventory.service("Department.Inventory.Service.Component",["$uibModal","$state",function(e,t){function a(e,t){e.Alerts=[{type:t.type,message:t.message,timeout:1200}],e.CloseAlert=function(t){e.Alerts.splice(t,1)}}function n(t,a,n,r){t.Modal.type=n;var o=e.open({animation:!0,backdrop:"static",templateUrl:r+".html",controller:a,size:"lg",scope:t});return t.Modal.confirm=function(){return console.log(t.parent.itemNameExist),0==t.ResourceItem.shareFreqItemSelection.length||t.parent.itemNameExist?void(t.shareFreqEmpty=!0):void o.close(t.Modal)},t.Modal.cancel=function(){o.dismiss()},o}return{popAlert:a,popModal:n}}]),DInventory.directive("fileModel",["$parse",function(e){return{restrict:"A",link:function(t,a,n){var r=e(n.fileModel),o=r.assign;t.parentIvntObj={},a.bind("change",function(){var e=/(xls|xlsx)/i,n=a[0].files[0].name,r=n.substring(n.lastIndexOf(".")+1);e.test(r)?(t.parentIvntObj.fileNameError=!1,t.$apply(function(){o(t,a[0].files[0])})):t.$apply(function(){t.parentIvntObj.fileNameError=!0})})}}}]);var Department=angular.module("Department",["ui.router"]);Department.controller("Department.Controller.Main",["$cookies","$scope","$q","Department.Service.Http","$sce","$state",function(e,t,a,n,r,o){function i(){t.depSelect.show=!1,t.followDeptList=t.parentObj.outputAllDeptList;var e=[];_(t.followDeptList).forEach(function(t){var a={};a.follow_dep_id=t.dep_id,e.push(a)}),n.followDepts({userdep:e}).then(function(e){})}function s(){t.mainAuditPromise=n.getAuditList(y).then(function(e){t.toAuditList=e.data.body[0].results,t.auditTotal=e.data.body[0].count})}function l(){v.response_dep_id=c,console.log(v),t.mainReqPromise=n.getDepartmentRequirementList(v).then(function(e){t.requireToConfirmList=e.data.body[0].results,t.reqTotal=e.data.body[0].count})}var d=JSON.parse(e.get("User")),c=d.dep_id,u=1,m=2,p=3,f=5,g=11,h=14,y={};y.limit=10,y.skip=0;var v={};v.limit=10,v.skip=0,t.depSelect={},t.followDeptList=[],t.parentObj={},s(),l(),n.getSystemDictByCatagory({dict_category:f}).then(function(e){t.secretFlagList=e.data.body}),n.getSystemDictByCatagory({dict_category:u}).then(function(e){t.shareFrequencyList=e.data.body}),n.getSystemDictByCatagory({dict_category:p}).then(function(e){t.shareLevelList=e.data.body}),n.getSystemDictByCatagory({dict_category:g}).then(function(e){t.resourceFormatList=e.data.body}),n.getSystemDictByCatagory({dict_category:m}).then(function(e){t.dataLevelList=e.data.body}),n.getSystemDictByCatagory({dict_category:h}).then(function(e){t.socialOpenList=e.data.body}),n.getDepDataQuotaTotal().then(function(e){t.Count=e.data.body[0]}),t.auditMore=function(){o.go("main.department.audit",{},{reload:!0})},t.reqMore=function(){o.go("main.department.requirement",{},{reload:!0})},n.getFollowDepList().then(function(e){t.parentObj.outputAllDeptList=e.data.body,t.followDeptList=_.uniq(t.parentObj.outputAllDeptList),n.getDepartmentFollowList().then(function(e){t.parentObj.deptAllList=_.remove(e.data.body,function(e){return e.dep_id!=c}),t.parentObj.outputDeptList=[],_(t.parentObj.deptAllList).forEach(function(e){e.icon="<img  src=styles/images/bureau/"+e.dep_en_name+" />",_(t.parentObj.outputAllDeptList).forEach(function(a){e.dep_id==a.dep_id&&(e.ticked=!0,t.parentObj.outputDeptList.push(e))})}),t.$broadcast("someEvent",t.parentObj.outputDeptList)})}),t.openFn=function(){t.parentObj.outputAllDeptList=t.parentObj.outputDeptList,console.log(t.parentObj.outputAllDeptList)},t.followDep=function(){i()}}]),Department.factory("Department.Service.Http",["$http","$q","API",function(e,t,a){function n(){return e.get(c+"/follow_sys_dep")}function r(){return e.get(c+"/depquota/summary")}function o(t){return e.get(c+"/sys_dict",{params:t})}function i(t){return e.get(c+"/depresource/wait_audit",{params:t})}function s(t){return e.get(c+"/data_requiement",{params:t})}function l(){return e.get(c+"/followed_user_dep")}function d(t){return e.post(c+"/user_dep_batch",{data:t})}var c=a.path;return{getSystemDictByCatagory:o,getAuditList:i,getDepartmentRequirementList:s,getDepartmentFollowList:n,getDepDataQuotaTotal:r,followDepts:d,getFollowDepList:l}}]);var DepartmentReq=angular.module("Department.Requirement",["ui.router"]);DepartmentReq.controller("Department.Requirement.Controller.Main",["$cookies","$scope","$stateParams","Department.Requirement.Service.Component","Department.Requirement.Service.Http",function(e,t,a,n,r){function o(){c.dep_id=s,t.reqPromise=r.getDepartmentRequirementList(c).then(function(e){t.requirementList=e.data.body[0].results,t.Paging.totalItems=e.data.body[0].count})}var i=JSON.parse(e.get("User")),s=i.dep_id,l=1,d=2;t.DeptRequirement={},t.Paging={},t.Paging.maxSize=5,t.Paging.itemsPerPage=10;var c={};c.limit=10,c.skip=0,t.Paging.pageChanged=function(){c.skip=(t.Paging.currentPage-1)*c.limit,o(c)},o(),r.getDepartmentList().then(function(e){t.deptList=e.data.body;_.remove(t.deptList,function(e){return e.id==s})}),r.getSystemDictByCatagory({dict_category:l}).then(function(e){t.shareFrequencyList=e.data.body}),r.getSystemDictByCatagory({dict_category:d}).then(function(e){t.dataLevelList=e.data.body}),t.toggleDataLevelReqSelection=function(e){var a=t.dataLevelReqSelection.indexOf(e.id);a>-1?t.dataLevelReqSelection.splice(a,1):t.dataLevelReqSelection.push(e.id)},t.toggleShareFreqSelection=function(e){var a=t.shareFreqSelection.indexOf(e.id);a>-1?t.shareFreqSelection.splice(a,1):t.shareFreqSelection.push(e.id)},t.publishReq=function(){t.Modal={},t.Modal.DepRequirment={};var e={},a=[];t.reqParent={},t.reqParent.outputDeptList=[],t.shareFreqSelection=[],t.dataLevelReqSelection=[],n.popModal(t,"发布","add-req-modal").result.then(function(){_(t.dataLevelReqSelection).forEach(function(e){var n={};n.datarequiementId=t.Modal.DepRequirment.requiement_name,n.sys_dict_id=e,n.obj_type=2,a.push(n)}),_(t.shareFreqSelection).forEach(function(e){var n={};n.datarequiementId=t.Modal.DepRequirment.requiement_name,n.sys_dict_id=e,n.obj_type=2,a.push(n)});var n=_.map(t.reqParent.outputDeptList,"id");console.log(n),t.Modal.DepRequirment.response_dep_id=n[0],e.dataRequiement=t.Modal.DepRequirment,e.dataRelationConfig=a,r.publishRequirement(e).then(function(e){200==e.data.head.status?(alert("发布成功"),o()):alert("发布失败")})})},t.searchDeptReqByName=function(){c.requiement_name=t.DeptRequirement.req_name_filter,c.limit=10,c.skip=0,o()},t.deleteReq=function(e){var t=confirm("确定删除本条需求？删除后将不可恢复。");t&&r.deleteRequirement({requiement_id:e}).then(function(e){200==e.data.head.status?(alert("删除成功！"),o()):alert("删除失败！")})},t.updateReq=function(e){t.Modal={},t.Modal.DepRequirment=e;var a={},i=[];t.reqParent={},t.reqParent.outputDeptList=[],t.shareFreqSelection=[],t.dataLevelReqSelection=[],_(t.deptList).forEach(function(a){e.response_dep_id==a.id&&(a.ticked=!0,t.reqParent.outputDeptList.push(a))}),r.getReqUpdatePeriod({requiement_id:e.id}).then(function(e){t.shareFreqSelection=e.data.body}),r.getReqAreaLevel({requiement_id:e.id}).then(function(e){t.dataLevelReqSelection=e.data.body}),n.popModal(t,"修改","add-req-modal").result.then(function(){_(t.dataLevelReqSelection).forEach(function(e){var a={};a.datarequiementId=t.Modal.DepRequirment.id,a.sys_dict_id=e,a.obj_type=2,i.push(a)}),_(t.shareFreqSelection).forEach(function(e){var a={};a.datarequiementId=t.Modal.DepRequirment.id,a.sys_dict_id=e,a.obj_type=2,i.push(a)});var e=_.map(t.reqParent.outputDeptList,"id");t.Modal.DepRequirment.response_dep_id=e[0],a.dataRequiement=t.Modal.DepRequirment,a.dataRelationConfig=i,r.updateRequirementInfo(a).then(function(e){200==e.data.head.status?(alert("修改成功"),o()):alert("修改失败")})})}}]),DepartmentReq.controller("Department.Requirement.Controller.confirm",["$cookies","$scope","$stateParams","Department.Requirement.Service.Http","Department.Requirement.Service.Component",function(e,t,a,n,r){function o(){l.response_dep_id=s,t.reqConfirmPromise=n.getDepartmentRequirementList(l).then(function(e){t.requirementConfirmList=e.data.body[0].results,t.Paging.totalItems=e.data.body[0].count})}t.Modal={},t.DeptRequirementConfirm={};var i=JSON.parse(e.get("User")),s=i.dep_id;t.DeptRequirement={},t.Paging={},t.Paging.maxSize=5,t.Paging.itemsPerPage=10;var l={};l.limit=10,l.skip=0,t.Paging.pageChanged=function(){l.skip=(t.Paging.currentPage-1)*l.limit,o(l)},o(),t.searchDeptReqConfirmByName=function(){l.requiement_name=t.DeptRequirementConfirm.req_name_filter,l.limit=10,l.skip=0,o()},n.getDeptInfoResourceList().then(function(e){console.log(e),t.depInfoResourceList=e.data.body[0].results}),t.toConfirm=function(e){t.Modal.ReqDetail=e,t.Modal.ReqResponse={},console.log(t.depInfoResourceList.length),0==t.depInfoResourceList.length?(t.Modal.ReqResponse.resource_id="",t.errorMsg="本部门还未发布任何信息资源",t.dataQuotaIdNull=!0):t.Modal.ReqResponse.resource_id=t.depInfoResourceList[0].id,r.popModalConfirm(t,"","confirm-req-modal").result.then(function(){console.log(t.Modal.ReqResponse),t.Modal.ReqResponse.requiement_id=e.id,n.updateRequirement(t.Modal.ReqResponse).then(function(a){200==a.data.head.status?1==t.Modal.ReqResponse.status?n.saveReqResponse({requiement_id:e.id,resource_id:t.Modal.ReqResponse.resource_id}).then(function(e){200==e.data.head.status?(alert("保存成功！"),o()):(alert("保存失败！"),o())}):(alert("保存成功！"),o()):alert("保存失败")})})}}]),DepartmentReq.controller("Department.Requirement.Controller.detail",["$scope","$stateParams","Department.Requirement.Service.Http","Department.Requirement.Service.Component",function(e,t,a,n){console.log(t.ID),a.getReqDetail({requiement_id:t.ID}).then(function(t){console.log(t.data.body[0]),e.ReqDetail=t.data.body[0]})}]),DepartmentReq.factory("Department.Requirement.Service.Http",["$http","API",function(e,t){function a(t){return e.get(g+"/data_requiement",{params:t})}function n(t){return e.post(g+"/data_requiement",{data:t})}function r(t){return e.put(g+"/data_requiement_ok",{data:t})}function o(t){return e.put(g+"/data_requiement",{data:t})}function i(t){return e.post(g+"/data_requiement_response",{data:t})}function s(t){return e.get(g+"/info_resource_list",{params:t})}function l(t){return e.get(g+"/data_requiement_detail",{params:t})}function d(t){return e.get(g+"/requirement/requireResponseList",{params:t})}function c(){return e.get(g+"/sys_dep")}function u(t){return e["delete"](g+"/data_requiement",{data:t})}function m(t){return e.get(g+"/sys_dict",{params:t})}function p(t){return e.get(g+"/requiement_update_period",{params:t})}function f(t){return e.get(g+"/requiement_area_level",{params:t})}var g=t.path;return{getDepartmentRequirementList:a,publishRequirement:n,getReqDetail:l,getResponseList:d,updateRequirement:r,updateRequirementInfo:o,saveReqResponse:i,getDeptInfoResourceList:s,getDepartmentList:c,deleteRequirement:u,getSystemDictByCatagory:m,getReqUpdatePeriod:p,getReqAreaLevel:f}}]),DepartmentReq.service("Department.Requirement.Service.Component",["$uibModal",function(e){function t(e,t){e.Alerts=[{type:t.type,message:t.message,timeout:1200}],e.CloseAlert=function(t){e.Alerts.splice(t,1)}}function a(t,a,n){t.Modal.type=a;var r=e.open({animation:!0,backdrop:"static",templateUrl:n+".html",scope:t,size:"lg"});return t.Modal.confirm=function(e){console.log(t),e&&r.close(t.Modal)},t.Modal.cancel=function(){r.dismiss()},r}function n(t,a,n){t.Modal.type=a;var r=e.open({animation:!0,backdrop:"static",templateUrl:n+".html",scope:t,size:"lg"});return t.Modal.confirm=function(e){console.log(t),e&&t.reqParent.outputDeptList.length>0?r.close(t.Modal):t.error=!0},t.Modal.cancel=function(){r.dismiss()},r}return{popAlert:t,popModal:n,popModalConfirm:a}}]);var DepartmentShare=angular.module("DepartmentShare",["ui.router"]);DepartmentShare.controller("DepartmentShare.Controller.Main",["$scope","DepartmentShare.Service.Http",function(e,t){function a(a){e.sharePromise=t.shareInfoResourceList(a).then(function(t){e.depShareList=t.data.body[0].results,e.Paging.totalItems=t.data.body[0].count})}e.DepartInfoResource={},e.Paging={},e.Paging.maxSize=5,e.Paging.itemsPerPage=10;var n={};n.limit=10,n.skip=0,e.Paging.pageChanged=function(){n.skip=(e.Paging.currentPage-1)*n.limit,a(n)},a(n),e.getResFormatAll=function(){e.resFormatMainSelection=[],n.re_format=null,n.limit=10,n.skip=0,a(n)},e.getShareLevelAll=function(){e.shareLvMainSelection=[],n.share_level=null,n.limit=10,n.skip=0,a(n)},e.getSocialOpenAll=function(){e.socialOpenMainSelection=[],n.social_open_flag=null,n.limit=10,n.skip=0,a(n)},e.getShareFreqAll=function(){e.shareFreqSelection=[],n.update_period=null,n.limit=10,n.skip=0,a(n)},e.getSecretFlagAll=function(){e.secretFlagMainSelection=[],n.issecret=null,n.limit=10,n.skip=0,a(n)},e.resFormatMainSelection=[],e.getInfoResourceByResFormat=function(t){var r=e.shareFreqSelection.indexOf(t.id);r>-1?e.resFormatMainSelection=[]:e.resFormatMainSelection=t.id,n.re_format=e.resFormatMainSelection,n.limit=10,n.skip=0,a(n)},e.shareFreqSelection=[],e.getInfoResourceListBySF=function(t){var r=e.shareFreqSelection.indexOf(t.id);r>-1?e.shareFreqSelection=[]:e.shareFreqSelection=t.id,n.update_period=e.shareFreqSelection,n.limit=10,n.skip=0,a(n)},e.shareLvMainSelection=[],e.getInfoResourceListBySl=function(t){var r=e.shareLvMainSelection.indexOf(t.id);r>-1?e.shareLvMainSelection=[]:e.shareLvMainSelection=t.id,n.share_level=e.shareLvMainSelection,n.limit=10,n.skip=0,a(n)},e.socialOpenMainSelection=[],e.getInfoResourceListBySO=function(t){var r=e.socialOpenMainSelection.indexOf(t.dict_code);r>-1?e.socialOpenMainSelection=[]:e.socialOpenMainSelection=t.dict_code,n.social_open_flag=e.socialOpenMainSelection,n.limit=10,n.skip=0,a(n)},e.secretFlagMainSelection=[],e.getInfoResourceListBySecFlag=function(t){var r=e.secretFlagMainSelection.indexOf(t.id);r>-1?e.secretFlagMainSelection=[]:e.secretFlagMainSelection=t.id,n.issecret=e.secretFlagMainSelection,n.limit=10,n.skip=0,a(n)},e.getSpatialAll=function(){e.areaMainSelection=[],n.area_level=null,n.limit=10,n.skip=0,a(n)},e.areaMainSelection=[],e.getInfoResourceListByAP=function(t){var r=e.areaMainSelection.indexOf(t.id);r>-1?e.areaMainSelection.splice(r,1):e.areaMainSelection.push(t.id),n.area_level=e.areaMainSelection,n.limit=10,n.skip=0,a(n)},e.searchDeptInfoResourceByName=function(){n.resource_name=e.DepartInfoResource.resource_name_filter,n.limit=10,n.skip=0,a(n)};var r=1,o=2,i=3,s=5,l=11,d=14;t.getSystemDictByCatagory({dict_category:s}).then(function(t){e.secretFlagList=t.data.body}),t.getSystemDictByCatagory({dict_category:r}).then(function(t){e.shareFrequencyList=t.data.body}),t.getSystemDictByCatagory({dict_category:i}).then(function(t){e.shareLevelList=t.data.body}),t.getSystemDictByCatagory({dict_category:l}).then(function(t){e.resourceFormatList=t.data.body}),t.getSystemDictByCatagory({dict_category:o}).then(function(t){e.dataLevelList=t.data.body}),t.getSystemDictByCatagory({dict_category:d}).then(function(t){e.socialOpenList=t.data.body})}]),DepartmentShare.controller("DepartmentShare.Controller.detail",["$scope","DepartmentShare.Service.Http","$stateParams",function(e,t,a){t.getQuotaDetail({data_quota_id:a.ID}).then(function(t){e.DataQuotaDetail=t.data.body[0]})}]),DepartmentShare.factory("DepartmentShare.Service.Http",["$http","API",function(e,t){function a(t){return e.get(s+"/share_list",{params:t})}function n(t){return e.get(s+"/data_quota_detail",{params:t})}function r(t){return e.post(s+"/user_dep",{data:t})}function o(t){return e.get(s+"/sys_dict",{params:t})}function i(t){return e["delete"](s+"/user_dep",{data:t})}var s=t.path;return{getSystemDictByCatagory:o,shareInfoResourceList:a,getQuotaDetail:n,followDepartment:r,cancelFollowDepartment:i}}]);var SystemUser=angular.module("Department.SystemUser",["ui.router"]);SystemUser.controller("Department.SystemUser.Controller.Main",["$scope","$q","Department.SystemUser.Service.Http","Department.SystemUser.Service.Component","$uibModal",function(e,t,a,n,r){function o(){a.getUserList().then(function(t){e.users=t.data.body,e.DepUserTotal=t.data.head.total})}e.Modal={},e.deptList=[],o(),e.addUserModal=function(){e.Modal={},e.sysUser={},n.popModal(e,"添加","add-user-modal").result.then(function(){a.saveUser(e.sysUser).then(function(e){200==e.data.head.status?(alert("添加成功"),o()):alert("添加失败")})})},e.searchUser=function(){var t=e.username;alert(t)},e.updateUser=function(t){t.DEP_NAME=null,e.sysUser=t,n.popModal(e,"修改","add-user-modal").result.then(function(){a.updateUser(e.sysUser).then(function(e){200==e.data.head.status?(alert("修改成功"),o()):alert("修改失败")})})},e.deleteUser=function(e){console.log(e);var t=confirm("确定要删除吗？");t&&a.deleteUser(e).then(function(e){console.log(e.data),200==e.data.head.status?(alert("删除成功"),o()):alert("删除失败！"),o()})}}]),SystemUser.factory("Department.SystemUser.Service.Http",["$http","$q","API",function(e,t,a){function n(){return e.get(d+"/user")}function r(t){return e.get(d+"/user",{params:t})}function o(t){return e.post(d+"/user",{data:t})}function i(){return e.get(d+"/dep/")}function s(t){return e.put(d+"/user/",{data:t})}function l(t){return e["delete"](d+"/user",{data:{ID:t.ID}})}var d=a.path;return{getUserList:n,saveUser:o,getDepartmentList:i,updateUser:s,deleteUser:l,getUser:r}}]),SystemUser.service("Department.SystemUser.Service.Component",["$uibModal",function(e){function t(e,t){e.Alerts=[{type:t.type,message:t.message,timeout:1200}],e.CloseAlert=function(t){e.Alerts.splice(t,1)}}function a(t,a,n){t.Modal.type=a;var r=e.open({animation:!0,backdrop:"static",templateUrl:n+".html",scope:t});return t.Modal.confirm=function(e){e&&r.close(t.Modal)},t.Modal.cancel=function(){r.dismiss()},r}return{popAlert:t,popModal:a}}]);
//# sourceMappingURL=app.min.js.map
